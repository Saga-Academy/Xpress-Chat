<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Xpress Chat | Pilot Registration</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body.signup-theme {
    font-family: 'Rajdhani', sans-serif;
    background: #000;
    color: #fff;
    min-height: 100vh;
    overflow-y: auto;
    position: relative;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
      radial-gradient(circle at 20% 50%, rgba(0, 100, 255, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 0, 100, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 80%, rgba(0, 255, 200, 0.1) 0%, transparent 50%);
    z-index: 1;
  }

  .stars {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .star {
    position: absolute;
    background-color: white;
    border-radius: 50%;
    animation: twinkle 3s infinite;
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.2; }
    50% { opacity: 1; }
  }

  .signup-container {
    position: relative;
    z-index: 3;
    max-width: 500px;
    margin: 50px auto;
    padding: 2rem;
    background: rgba(0, 20, 40, 0.85);
    backdrop-filter: blur(10px);
    border: 2px solid #00aaff;
    border-radius: 10px;
    box-shadow: 0 0 50px rgba(0, 170, 255, 0.5);
  }

  .signup-container h2 {
    font-family: 'Orbitron', sans-serif;
    text-align: center;
    margin-bottom: 1rem;
    color: #00aaff;
    font-size: 2rem;
    text-shadow: 0 0 10px #00aaff;
  }

  .signup-container h3 {
    font-family: 'Orbitron', sans-serif;
    text-align: center;
    margin-bottom: 1rem;
    color: #00aaff;
    font-size: 1.2rem;
  }

  .signup-container input, .signup-container select {
    width: 100%;
    padding: 12px 16px;
    margin: 10px 0;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid #00aaff;
    border-radius: 5px;
    color: white;
    font-size: 1rem;
    font-family: 'Rajdhani', sans-serif;
  }

  .signup-container input::placeholder, .signup-container select option {
    color: rgba(255, 255, 255, 0.6);
  }

  .signup-container input:focus, .signup-container select:focus {
    outline: none;
    box-shadow: 0 0 10px #00aaff;
    background: rgba(255, 255, 255, 0.15);
  }

  .signup-container button {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    border: none;
    border-radius: 5px;
    font-family: 'Orbitron', sans-serif;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
  }

  .signup-container button.primary {
    background: #00aaff;
    color: white;
  }

  .signup-container button.secondary {
    background: transparent;
    color: #00aaff;
    border: 2px solid #00aaff;
  }

  .signup-container button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 170, 255, 0.4);
  }

  .message {
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    text-align: center;
    font-weight: bold;
  }

  .error {
    background: rgba(255, 0, 0, 0.2);
    color: #ff6666;
    border: 1px solid #ff6666;
  }

  .success {
    background: rgba(0, 255, 0, 0.2);
    color: #66ff66;
    border: 1px solid #66ff66;
  }

  .spinner {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #00aaff;
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Avatar Gallery */
  .avatar-section {
    margin: 20px 0;
    padding: 15px;
    background: rgba(0, 170, 255, 0.1);
    border-radius: 5px;
    border: 1px solid #00aaff;
  }

  .avatar-section h4 {
    color: #00aaff;
    margin-bottom: 15px;
    font-family: 'Orbitron', sans-serif;
    text-align: center;
  }

  .avatar-gallery {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    margin-bottom: 15px;
  }

  .avatar-option {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
  }

  .avatar-option:hover {
    transform: scale(1.1);
    border-color: #00aaff;
  }

  .avatar-option.selected {
    border-color: #00aaff;
    box-shadow: 0 0 10px #00aaff;
  }

  .avatar-custom {
    display: flex;
    gap: 10px;
    margin-top: 15px;
  }

  .avatar-custom input {
    flex: 1;
    margin: 0;
  }

  .avatar-custom button {
    width: auto;
    padding: 8px 15px;
    background: rgba(0, 170, 255, 0.2);
    border: 1px solid #00aaff;
    color: white;
  }

  .current-avatar {
    text-align: center;
    margin: 15px 0;
  }

  #selectedAvatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 3px solid #00aaff;
    margin: 0 auto 10px;
    object-fit: cover;
  }

  .avatar-source {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 10px;
  }

  .source-btn {
    padding: 8px 15px;
    background: rgba(0, 170, 255, 0.2);
    border: 1px solid #00aaff;
    border-radius: 5px;
    color: white;
    cursor: pointer;
    font-size: 0.9rem;
  }

  .source-btn.active {
    background: #00aaff;
  }

  .demo-section {
    margin-top: 20px;
    padding: 15px;
    background: rgba(0, 170, 255, 0.1);
    border-radius: 5px;
    border: 1px solid #00aaff;
  }

  .demo-buttons {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 5px;
    margin-top: 10px;
  }

  .demo-buttons button {
    padding: 8px 12px;
    background: rgba(0, 170, 255, 0.2);
    border: 1px solid #00aaff;
    border-radius: 3px;
    color: white;
    font-size: 0.8rem;
    cursor: pointer;
  }

  .demo-buttons button:hover {
    background: rgba(0, 170, 255, 0.3);
    transform: translateY(-1px);
  }

  .back-link {
    text-align: center;
    margin-top: 20px;
  }

  .back-link a {
    color: #00aaff;
    text-decoration: none;
    font-size: 0.9rem;
  }

  .back-link a:hover {
    text-decoration: underline;
  }

  @media (max-width: 600px) {
    .signup-container {
      margin: 30px 15px;
      padding: 1.5rem;
    }
    
    .signup-container h2 {
      font-size: 1.5rem;
    }
    
    .avatar-gallery {
      grid-template-columns: repeat(3, 1fr);
    }
    
    .demo-buttons {
      grid-template-columns: 1fr;
    }
    
    .avatar-custom {
      flex-direction: column;
    }
    
    .avatar-custom button {
      width: 100%;
    }
  }
</style>
</head>

<body class="signup-theme">

<div class="overlay"></div>
<div class="stars" id="starsContainer"></div>

<div class="signup-container">
  <h2>PILOT REGISTRATION</h2>
  <h3>Create Your Galactic Identity</h3>

  <input type="email" id="email" placeholder="Pilot Email Address" required>
  <input type="password" id="password" placeholder="Create Holo-Key (Min. 6 characters)" required minlength="6">
  <input type="text" id="displayName" placeholder="Pilot Callsign (Optional)">

  <!-- Avatar Selection Section -->
  <div class="avatar-section">
    <h4>Select Your Avatar</h4>
    
    <div class="current-avatar">
      <img id="selectedAvatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=default" alt="Selected Avatar">
      <div id="avatarName">Default Avatar</div>
    </div>

    <div class="avatar-source">
      <button class="source-btn active" onclick="switchAvatarSource('gallery')">
        <i class="fas fa-images"></i> Gallery
      </button>
      <button class="source-btn" onclick="switchAvatarSource('custom')">
        <i class="fas fa-link"></i> Custom URL
      </button>
      <button class="source-btn" onclick="switchAvatarSource('generate')">
        <i class="fas fa-robot"></i> Generate
      </button>
    </div>

    <!-- Avatar Gallery -->
    <div id="avatarGallery" class="avatar-gallery">
      <!-- Gallery avatars will be loaded here -->
    </div>

    <!-- Custom URL Input -->
    <div id="customAvatarSection" class="avatar-custom" style="display: none;">
      <input type="url" id="customAvatarUrl" placeholder="Enter image URL (jpg, png, gif)">
      <button onclick="useCustomAvatar()">Use This Avatar</button>
    </div>

    <!-- Generate Avatar -->
    <div id="generateAvatarSection" class="avatar-custom" style="display: none;">
      <input type="text" id="generateSeed" placeholder="Enter text to generate avatar">
      <button onclick="generateAvatar()">Generate Avatar</button>
    </div>
  </div>

  <button class="primary" onclick="handleSignUp()">
    <i class="fas fa-user-astronaut"></i> REGISTER PILOT
  </button>

  <div class="demo-section">
    <h4>Quick Demo Access</h4>
    <p style="font-size: 0.9rem; color: #88ccff; margin-bottom: 10px;">
      Try our demo accounts (no registration needed):
    </p>
    <div class="demo-buttons">
      <button onclick="fillDemoAccount('luke@jedi.com', 'force123', 'Luke Skywalker')">
        <i class="fas fa-jedi"></i> Luke Skywalker
      </button>
      <button onclick="fillDemoAccount('leia@rebel.com', 'princess123', 'Princess Leia')">
        <i class="fas fa-queen"></i> Princess Leia
      </button>
      <button onclick="fillDemoAccount('han@falcon.com', 'nerf123', 'Han Solo')">
        <i class="fas fa-user"></i> Han Solo
      </button>
      <button onclick="fillDemoAccount('darth@sith.com', 'vader123', 'Darth Vader')">
        <i class="fas fa-helmet-battle"></i> Darth Vader
      </button>
      <button onclick="fillDemoAccount('yoda@jedi.com', 'master123', 'Master Yoda')">
        <i class="fas fa-hat-wizard"></i> Master Yoda
      </button>
      <button onclick="fillDemoAccount('obiwan@jedi.com', 'hello123', 'Obi-Wan')">
        <i class="fas fa-user-ninja"></i> Obi-Wan
      </button>
    </div>
  </div>

  <div class="back-link">
    <a href="login.html">
      <i class="fas fa-arrow-left"></i> Already registered? Login here
    </a>
  </div>
</div>

<script>
  // Star Wars themed avatar collection
  const AVATAR_GALLERY = [
    // Jedi/Sith Characters
    { id: 'jedi1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=jedi1&backgroundColor=00aaff', name: 'Jedi Master' },
    { id: 'jedi2', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=jedi2&backgroundColor=4a90e2', name: 'Jedi Knight' },
    { id: 'sith1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=sith1&backgroundColor=ff4444', name: 'Sith Lord' },
    { id: 'sith2', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=sith2&backgroundColor=ff2222', name: 'Sith Apprentice' },
    
    // Star Wars Inspired
    { id: 'pilot1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=pilot1&backgroundColor=333333', name: 'Rebel Pilot' },
    { id: 'pilot2', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=pilot2&backgroundColor=666666', name: 'Imperial Pilot' },
    { id: 'droid1', url: 'https://api.dicebear.com/7.x/bots/svg?seed=r2d2', name: 'Astromech Droid' },
    { id: 'droid2', url: 'https://api.dicebear.com/7.x/bots/svg?seed=c3po', name: 'Protocol Droid' },
    
    // Sci-Fi Avatars
    { id: 'cyborg1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=cyborg1&backgroundColor=00aaff', name: 'Cyborg' },
    { id: 'alien1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=alien1&backgroundColor=00ff88', name: 'Alien' },
    { id: 'alien2', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=alien2&backgroundColor=ff00ff', name: 'Xenomorph' },
    { id: 'alien3', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=alien3&backgroundColor=ffff00', name: 'Zetan' },
    
    // Cool Sci-Fi
    { id: 'hacker1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=hacker1&backgroundColor=000000', name: 'Hacker' },
    { id: 'agent1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=agent1&backgroundColor=333333', name: 'Special Agent' },
    { id: 'explorer1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=explorer1&backgroundColor=00aaff', name: 'Space Explorer' },
    { id: 'commander1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=commander1&backgroundColor=ff6600', name: 'Commander' },
    
    // More Variations
    { id: 'female1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=female1&backgroundColor=ff66aa', name: 'Female Pilot' },
    { id: 'male1', url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=male1&backgroundColor=0066ff', name: 'Male Pilot' },
    { id: 'robot1', url: 'https://api.dicebear.com/7.x/bots/svg?seed=robot1', name: 'Robot' },
    { id: 'robot2', url: 'https://api.dicebear.com/7.x/bots/svg?seed=robot2', name: 'Android' }
  ];

  // Create stars animation
  function createStars() {
    const container = document.getElementById('starsContainer');
    const starCount = 200;
    
    for (let i = 0; i < starCount; i++) {
      const star = document.createElement('div');
      star.classList.add('star');
      
      const x = Math.random() * 100;
      const y = Math.random() * 100;
      const size = Math.random() * 2 + 0.5;
      const delay = Math.random() * 3;
      
      star.style.left = `${x}%`;
      star.style.top = `${y}%`;
      star.style.width = `${size}px`;
      star.style.height = `${size}px`;
      star.style.animationDelay = `${delay}s`;
      
      container.appendChild(star);
    }
  }

  // Load avatar gallery
  function loadAvatarGallery() {
    const gallery = document.getElementById('avatarGallery');
    gallery.innerHTML = '';
    
    AVATAR_GALLERY.forEach(avatar => {
      const img = document.createElement('img');
      img.className = 'avatar-option';
      img.src = avatar.url;
      img.alt = avatar.name;
      img.title = avatar.name;
      img.dataset.id = avatar.id;
      img.dataset.url = avatar.url;
      img.dataset.name = avatar.name;
      
      img.addEventListener('click', () => {
        selectAvatar(avatar.url, avatar.name);
        // Remove selection from all
        document.querySelectorAll('.avatar-option').forEach(el => {
          el.classList.remove('selected');
        });
        // Add to clicked
        img.classList.add('selected');
      });
      
      gallery.appendChild(img);
    });
  }

  // Select avatar
  function selectAvatar(url, name) {
    const selectedAvatar = document.getElementById('selectedAvatar');
    const avatarName = document.getElementById('avatarName');
    
    selectedAvatar.src = url;
    avatarName.textContent = name;
    
    // Store selected avatar
    window.selectedAvatarUrl = url;
  }

  // Switch avatar source
  function switchAvatarSource(source) {
    // Update active button
    document.querySelectorAll('.source-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Show/hide sections
    const gallerySection = document.getElementById('avatarGallery');
    const customSection = document.getElementById('customAvatarSection');
    const generateSection = document.getElementById('generateAvatarSection');
    
    if (source === 'gallery') {
      gallerySection.style.display = 'grid';
      customSection.style.display = 'none';
      generateSection.style.display = 'none';
    } else if (source === 'custom') {
      gallerySection.style.display = 'none';
      customSection.style.display = 'flex';
      generateSection.style.display = 'none';
    } else if (source === 'generate') {
      gallerySection.style.display = 'none';
      customSection.style.display = 'none';
      generateSection.style.display = 'flex';
    }
  }

  // Use custom avatar URL
  function useCustomAvatar() {
    const urlInput = document.getElementById('customAvatarUrl');
    const url = urlInput.value.trim();
    
    if (url) {
      if (isValidImageUrl(url)) {
        selectAvatar(url, 'Custom Avatar');
        showMessage('Custom avatar loaded successfully!', 'success');
      } else {
        showMessage('Please enter a valid image URL (jpg, png, gif, svg)', 'error');
      }
    } else {
      showMessage('Please enter an image URL', 'error');
    }
  }

  // Generate avatar from seed
  function generateAvatar() {
    const seedInput = document.getElementById('generateSeed');
    const seed = seedInput.value.trim() || Date.now().toString();
    
    const avatarUrl = `https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(seed)}&backgroundColor=00aaff`;
    selectAvatar(avatarUrl, `Generated: ${seed}`);
    showMessage('Avatar generated!', 'success');
  }

  // Validate image URL
  function isValidImageUrl(url) {
    const pattern = /^https?:\/\/.+\.(jpg|jpeg|png|gif|svg|webp)(\?.*)?$/i;
    return pattern.test(url);
  }

  // Fill demo account details
  function fillDemoAccount(email, password, name = '') {
    document.getElementById('email').value = email;
    document.getElementById('password').value = password;
    if (document.getElementById('displayName')) {
      document.getElementById('displayName').value = name;
    }
    showMessage(`Demo account "${name}" loaded. Click "REGISTER PILOT" to create a similar account.`, 'success');
    
    // Also set a demo avatar
    const randomAvatar = AVATAR_GALLERY[Math.floor(Math.random() * AVATAR_GALLERY.length)];
    selectAvatar(randomAvatar.url, randomAvatar.name);
  }

  // Show message function
  function showMessage(message, type = 'error') {
    const existingMsg = document.querySelector('.message');
    if (existingMsg) existingMsg.remove();
    
    const msgDiv = document.createElement('div');
    msgDiv.className = `message ${type}`;
    msgDiv.textContent = message;
    
    const container = document.querySelector('.signup-container');
    const buttons = container.querySelectorAll('button');
    container.insertBefore(msgDiv, buttons[0]);
    
    if (type !== 'error') {
      setTimeout(() => msgDiv.remove(), 5000);
    }
  }

  // Make functions globally available
  window.fillDemoAccount = fillDemoAccount;
  window.showMessage = showMessage;
  window.selectAvatar = selectAvatar;
  window.switchAvatarSource = switchAvatarSource;
  window.useCustomAvatar = useCustomAvatar;
  window.generateAvatar = generateAvatar;

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', () => {
    createStars();
    loadAvatarGallery();
    document.getElementById('email').focus();
    
    // Select first avatar by default
    if (AVATAR_GALLERY.length > 0) {
      selectAvatar(AVATAR_GALLERY[0].url, AVATAR_GALLERY[0].name);
      document.querySelector('.avatar-option').classList.add('selected');
    }
  });
</script>

<script type="module" src="./js/auth.js"></script>
</body>
</html>